select users.name,groups.name group_name,s1.user_id,s1.created_at,
case when s1.check_in_date=1 then times end day1,
case when s1.check_in_date=2 then times end day2,
case when s1.check_in_date=3 then times end day3,
case when s1.check_in_date=4 then times end day4,
case when s1.check_in_date=5 then times end day5,
case when s1.check_in_date=6 then times end day6,
case when s1.check_in_date=7 then times end day7,
case when s1.check_in_date=8 then times end day8,
case when s1.check_in_date=9 then times end day9,
case when s1.check_in_date=10 then times end day10,
case when s1.check_in_date=11 then times end day11,
case when s1.check_in_date=12 then times end day12,
case when s1.check_in_date=13 then times end day13,
case when s1.check_in_date=14 then times end day14,
case when s1.check_in_date=15 then times end day15,
case when s1.check_in_date=16 then times end day16,
case when s1.check_in_date=17 then times end day17,
case when s1.check_in_date=18 then times end day18,
case when s1.check_in_date=19 then times end day19,
case when s1.check_in_date=20 then times end day20,
case when s1.check_in_date=21 then times end day21,
case when s1.check_in_date=22 then times end day22,
case when s1.check_in_date=23 then times end day23,
case when s1.check_in_date=24 then times end day24,
case when s1.check_in_date=25 then times end day25,
case when s1.check_in_date=26 then times end day26,
case when s1.check_in_date=27 then times end day27,
case when s1.check_in_date=28 then times end day28,
case when s1.check_in_date=29 then times end day29,
case when s1.check_in_date=30 then times end day30,
case when s1.check_in_date=31 then times end day31  

from (
select s.user_id,s.created_at, s.check_in_date,round(CAST(s.check_out_time-s.check_in_time as numeric),2) times    
from (
Select a.user_id,a.created_at,date_part('day',a.created_at) check_in_date, date_part('hour', a.created_at) + round(CAST((date_part('minute', a.created_at)/60) as numeric),2) check_in_time, date_part('hour', b.created_at) + round( CAST((date_part('minute', b.created_at)/60) as numeric),2) check_out_time        
from check_ins a 
left outer join check_outs b on a.user_id=b.user_id and date_trunc('day',a.created_at) =date_trunc('day',b.created_at)
) s 
left outer join day_months on 1=1 
) s1
inner join users on s1.user_id=users.id
inner join user_groups on s1.user_id=user_groups.user_id
inner join groups on user_groups.group_id=groups.id
Where groups.id = <%= quote @group_id %> and date_part('month',s1.created_at)= <%= quote @month %>
Order by groups.name,users.name